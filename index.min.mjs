const r=Object.keys,e=r=>r.length,t=r=>typeof r,o=r=>"object"===t(r),n=Array.isArray,l=r=>null===r,f=r=>l(r)?"null":n(r)?"array":t(r),a=(r,e)=>f(r)!==f(e),i=(t,n)=>{if(t===n)return!0;if(a(t,n))return!1;if(!o(t))return!1;const l=r(t);if(e(l)!==e(r(n)))return!1;for(let r of l)if(!(r in n))return!1;for(let r of l)if(!i(t[r],n[r]))return!1;return!0},u=(r,e)=>r===e,s=r=>(e,t)=>e===t||!a(e,t)&&o(e)&&r(e)===r(t),c=r=>[r],d=r=>(e,...t)=>e[r](...t),v=d("flat"),y=r=>0===r,_=r=>void 0===r,h=d("push"),b=d("filter"),g=r=>2===r,p=r=>6===r,q=r=>3===r,j=r=>4===r,m=r=>n(r)&&1===e(r),w=r=>{return y(r)||j(r)||p(r)||q(r)||g(r)||m(r)||n(t=r)&&e(t)%2==0;var t},A=Number.isInteger,$=r=>"string"===t(r),x=r=>A(r)&&r>0||$(r),I=r=>n(r)&&2===e(r),M=r=>I(r)&&x(r[0])&&w(r[1])&&!j(r[1]),E=r=>A(r)&&r<0,O=r=>I(r)&&E(r[0])&&j(r[1]),k=r=>I(r)&&x(r[0])&&E(r[1]),N=r=>I(r)&&E(r[0])&&w(r[1])&&!j(r[1]),S=d("sort"),z=r=>S(r,((r,e)=>r[0]-e[0])),B=r=>[z(b(r,k)),z(b(r,N)),z(b(r,O)),z(b(r,M))],C=(r,t)=>{const{are_equal:o}=t,n=[];for(let e of r)if(_(e[1])&&!_(e[2]))for(let t of r)!_(t[1])&&_(t[2])&&o(t[1],e[2])&&(h(n,[e[0],t[0]]),e.length=t.length=0);for(let e of r){const r=W(e[1],e[2],t);y(r)||h(n,[e[0],r])}return e(n)>0?v(B(n),2):0},D=(r,e,t)=>e<0||t<0?-1:r[e][t],F=Array.from,G=Math.max,H=Math.min,J=d("slice"),K=(r,t,o)=>{const{are_equal:n}=o,l=e(r),f=e(t),a=H(l,f);let i=0;for(;i<a&&n(r[i],t[i]);)i++;let u=0;for(;u<a&&n(r[l-1-u],t[f-1-u]);)u++;const s=((r,t,o)=>{const n=e(r)+1,l=e(t)+1,f=F({length:l},(()=>Array(n).fill(0)));for(let e=1;e<l;e++)for(let l=1;l<n;l++)f[e][l]=o(r[l-1],t[e-1])?f[e-1][l-1]+1:G(f[e][l-1],f[e-1][l]);return f})(J(r,i,l-u),J(t,i,f-u),n),c=[];let d=f-i-u,v=l-i-u;for(;v>0||d>0;){const e=D(s,d,v-1),o=D(s,d-1,v),n=v+i-1,l=d+i-1;e>o?(h(c,[-(n+1),r[n],void 0]),v--):o>e?(h(c,[+(l+1),void 0,t[l]]),d--):(D(s,d,v)===D(s,d-1,v-1)&&h(c,[-(n+1),r[n],t[l]]),v--,d--)}return C(c,o)},L=(r,e,t)=>c(e),P=d("indexOf"),Q=e=>n(e)?r(e):S(r(e)),R=d("map"),T=(e,t,o)=>{const{are_equal:n}=o,l=Q(e);return C(R(b((f=[...r(e),...r(t)],[...new Set(f)]),(r=>!n(e[r],t[r]))),(r=>[_(e[r])?r:-(P(l,r)+1),e[r],t[r]])),o);var f},U=(r,e,t)=>c(e),V=(r,e,t)=>{throw new Error(`Invalid value type "${f(r)}": ${r}`)},W=(r,e,t)=>r===e?0:_(e)?4:l(e)?6:!0===e?3:(r=>!1===r)(e)?2:a(r,e)?c(e):({array:K,number:L,object:T,string:U}[f(r)]||V)(r,e,t),X=r=>"function"===t(r),Y=(r,e,{get_object_id:t,are_equal:o=(X(t)?s(t):i)}={})=>W(r,e,{are_equal:o}),Z=(r,e,{get_object_id:t,are_equal:o=(X(t)?s(t):u)}={})=>W(r,e,{are_equal:o}),rr=Math.abs,er=r=>rr(r)-1,tr=(r,e)=>$(r)?r:E(r)?e[er(r)]:er(r),or=d("splice"),nr=(r,t)=>{const[o,l,f,a]=B(((r,t,o=0)=>{const n=[];for(;o<e(r);)h(n,r.slice(o,o+t)),o+=t;return n})(t,2)),i=Q(r);for(let e of o)h(f,[e[1],4]),h(a,[e[0],c(r[tr(e[1],i)])]);z(a),z(f);const u=n(r)?[...r]:{...r};for(let e of l){const t=tr(e[0],i);u[t]=ir(r[t],e[1])}for(let r of f){const e=tr(r[0],i);n(u)?or(u,e,1):delete u[e]}for(let r of a){const e=tr(r[0],i),t=ir(void 0,r[1]);n(u)?or(u,e,0,t):u[e]=t}return u},lr=nr,fr=nr,ar=(r,e)=>{throw new Error(`Invalid delta for value of type "${f(r)}": ${e}`)},ir=(r,e)=>y(e)?r:j(e)?void 0:p(e)?null:!!q(e)||!g(e)&&(m(e)?e[0]:({array:lr,object:fr}[f(r)]||ar)(r,e));export{i as are_deep_equal,u as are_strict_equal,Z as diff,Y as diff_deep_equal,Z as diff_strict_equal,ir as patch};
